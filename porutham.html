<!DOCTYPE html>
<html lang="ml">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>‡¥ï‡µá‡¥∞‡¥≥ ‡¥ú‡µç‡¥Ø‡µã‡¥§‡¥ø‡¥∑‡¥Ç | ‡¥µ‡¥ø‡¥µ‡¥æ‡¥π ‡¥™‡µä‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥Ç</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  font-family:"Noto Sans Malayalam", Arial, sans-serif;
  background:linear-gradient(135deg,#e8f5e9,#f1f8e9);
  margin:0;
  color:#1b5e20;
}
header{
  background:#1b5e20;
  color:#fff;
  padding:18px;
  text-align:center;
}
header h1{margin:0;font-size:28px;}
header p{margin-top:6px;font-size:14px;color:#c8e6c9;}
section{
  max-width:700px;
  margin:25px auto;
  background:#fff;
  padding:22px;
  border-radius:14px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}
h2{text-align:center;color:#2e7d32;}
h3{
  font-size:16px;
  margin-top:22px;
  border-left:4px solid #66bb6a;
  padding-left:8px;
}
label{display:block;margin-top:10px;font-weight:600;font-size:14px;}
input,select{
  width:100%;
  padding:9px;
  margin-top:4px;
  border-radius:6px;
  border:1px solid #a5d6a7;
}
.result{
  margin-top:18px;
  padding:14px;
  background:#e8f5e9;
  border-radius:8px;
  font-weight:bold;
  text-align:center;
}
</style>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>

<header>
  <h1>‡¥ï‡µá‡¥∞‡¥≥ ‡¥ú‡µç‡¥Ø‡µã‡¥§‡¥ø‡¥∑‡¥Ç</h1>
  <p>‡¥µ‡¥ø‡¥∂‡µç‡¥µ‡¥∏‡¥®‡µÄ‡¥Ø‡¥Æ‡¥æ‡¥Ø ‡¥µ‡¥ø‡¥µ‡¥æ‡¥π ‡¥™‡µä‡¥∞‡µÅ‡¥§‡µç‡¥§ ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥®</p>
</header>

<section>
<h2>‡¥µ‡¥ø‡¥µ‡¥æ‡¥π ‡¥™‡µä‡¥∞‡µÅ‡¥§‡µç‡¥§ ‡¥µ‡¥ø‡¥∂‡¥¶‡¥æ‡¥Ç‡¥∂‡¥ô‡µç‡¥ô‡µæ</h2>

<h3>üë® ‡¥µ‡¥∞‡µª</h3>
<label>‡¥™‡µá‡¥∞‡µç</label>
<input id="boyName">

<label>‡¥ú‡¥®‡¥® ‡¥§‡µÄ‡¥Ø‡¥§‡¥ø</label>
<input type="date" id="boyDOB">

<label>‡¥ú‡¥®‡¥® ‡¥∏‡¥Æ‡¥Ø‡¥Ç</label>
<input type="time" id="boyTOB">

<label>‡¥®‡¥ï‡µç‡¥∑‡¥§‡µç‡¥∞‡¥Ç</label>
<select id="boyStar">
  <option value="">-- ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï --</option>
  <option>Aswathy</option><option>Bharani</option><option>Karithika</option>
  <option>Rohini</option><option>Makayiram</option><option>Thiruvathira</option>
  <option>Punartham</option><option>Pooyam</option><option>Ayilyam</option>
  <option>Magham</option><option>Puram</option><option>Uttaram</option>
  <option>Atham</option><option>Chithra</option><option>Chothi</option>
  <option>Vishakham</option><option>Anizham</option><option>Thrikketta</option>
  <option>Mulam</option><option>Puradam</option><option>Uthradam</option>
  <option>Thiruvonam</option><option>Avittam</option><option>Chathayam</option>
  <option>Pururuttathi</option><option>Uthratathi</option><option>Revathi</option>
</select>

<h3>üë© ‡¥µ‡¥ß‡µÅ</h3>
<label>‡¥™‡µá‡¥∞‡µç</label>
<input id="girlName">

<label>‡¥ú‡¥®‡¥® ‡¥§‡µÄ‡¥Ø‡¥§‡¥ø</label>
<input type="date" id="girlDOB">

<label>‡¥ú‡¥®‡¥® ‡¥∏‡¥Æ‡¥Ø‡¥Ç</label>
<input type="time" id="girlTOB">

<label>‡¥®‡¥ï‡µç‡¥∑‡¥§‡µç‡¥∞‡¥Ç</label>
<select id="girlStar">
  <option value="">-- ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï --</option>
  <option>Aswathy</option><option>Bharani</option><option>Karithika</option>
  <option>Rohini</option><option>Makayiram</option><option>Thiruvathira</option>
  <option>Punartham</option><option>Pooyam</option><option>Ayilyam</option>
  <option>Magham</option><option>Puram</option><option>Uttaram</option>
  <option>Atham</option><option>Chithra</option><option>Chothi</option>
  <option>Vishakham</option><option>Anizham</option><option>Thrikketta</option>
  <option>Mulam</option><option>Puradam</option><option>Uthradam</option>
  <option>Thiruvonam</option><option>Avittam</option><option>Chathayam</option>
  <option>Pururuttathi</option><option>Uthratathi</option><option>Revathi</option>
</select>

<div class="result" id="result">‡¥é‡¥≤‡µç‡¥≤‡¥æ ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥Ç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï ‚Äì ‚Çπ10 ‡¥™‡µá‡¥Ø‡µç‚Äå‡¥Æ‡µÜ‡¥®‡µç‡¥±‡µç ‡¥ì‡¥ü‡µç‡¥ü‡µã ‡¥§‡µÅ‡¥±‡¥ï‡µç‡¥ï‡µÅ‡¥Ç</div>

</section>

<script>
function porutham(b,g){
  return b===g ? "‡¥â‡¥§‡µç‡¥§‡¥Æ‡¥Æ‡¥æ‡¥Ø ‡¥µ‡¥ø‡¥µ‡¥æ‡¥π ‡¥™‡µä‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥Ç ‚úÖ" : "‡¥∏‡¥æ‡¥ß‡¥æ‡¥∞‡¥£ ‡¥µ‡¥ø‡¥µ‡¥æ‡¥π ‡¥™‡µä‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥Ç ‚ö†Ô∏è";
}

function allFilled(){
  return boyName.value && girlName.value &&
         boyDOB.value && girlDOB.value &&
         boyTOB.value && girlTOB.value &&
         boyStar.value && girlStar.value;
}

async function startPayment(){

  // üî¥ BACKEND REQUIRED
  const order = await (await fetch("/create-order",{method:"POST"})).json();

  const options = {
    key: "YOUR_RAZORPAY_KEY_ID",
    amount: order.amount,
    currency: "INR",
    name: "Kerala Jyothisham",
    description: "Marriage Porutham",
    order_id: order.id,

    method:{ upi:true },
    upi:{
      flow:"intent",
      intents:["google_pay","phonepe","paytm"]
    },

    handler: async function (response) {

      const verify = await (await fetch("/verify-payment",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify(response)
      })).json();

      if(verify.verified){

        const res = porutham(boyStar.value, girlStar.value);
        result.innerHTML = boyName.value+" & "+girlName.value+"<br>"+res;

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text("‡¥ï‡µá‡¥∞‡¥≥ ‡¥ú‡µç‡¥Ø‡µã‡¥§‡¥ø‡¥∑‡¥Ç",105,20,null,null,"center");
        doc.text("‡¥µ‡¥∞‡µª : "+boyName.value,20,40);
        doc.text("‡¥µ‡¥ß‡µÅ : "+girlName.value,20,55);
        doc.text("‡¥´‡¥≤‡¥Ç : "+res,20,75);
        doc.save("Porutham.pdf");
      } else {
        alert("Payment Failed");
      }
    },
    theme:{color:"#2e7d32"}
  };

  new Razorpay(options).open();
}

// üî• AUTO PAYMENT TRIGGER
girlStar.addEventListener("change",()=>{
  if(allFilled()){
    startPayment();
  }
});
</script>

</body>
</html>
